## Ed25519 签名算法

应用于polkadot 等多个公链的签名算法。

Ed25519 是一种高效、安全的数字签名算法，基于 EdDSA（Edwards-curve Digital Signature Algorithm）和 Curve25519 椭圆曲线。它具有高性能和高安全性，非常适合于需要高效加密和签名的应用。

#### Ed25519 的特点

- **更小的签名:** Ed25519 的签名比 secp256k1 的签名更小，这使得它们更易于传输和存储。
- **更快的签名生成:** Ed25519 的签名生成速度比 secp256k1 的签名生成速度更快，这使得它们更适合于需要高性能的应用。
- **抗量子攻击:** Ed256k1 容易受到量子攻击，而 Ed25519 被认为是抗量子攻击的。

### 签名步骤：

1. 密钥生成： 

   1. 生成一个32字节的随机种子。

   2. 使用哈希函数SHA-512对种子进行哈希，生成64字节的哈希值 `h`。

   3. 从 `h` 中的前32字节 `h[0..31]` 生成一个标量 `a`。 `a` 是通过将这些字节解释为一个256位整数，并将某些位设置为固定值。

   4. 计算公钥 `A = a * B`，其中 `B` 是曲线上的基点。

      ```shell
      seed: random 32 bytes
      h = SHA-512(seed)
      a = prune(h[0..31])
      A = a * B
      public key: A
      private key: seed
      ```

2. 签名生成：

   1. 将消息 `M` 与 `seed` 的后32字节 `h[32..63]` 连接，并使用SHA-512进行哈希，得到 `r`。

   2. 将 `r` 解释为一个标量，并计算 `R = r * B`。

   3. 计算哈希 `H(R || A || M)`，并将结果解释为一个标量 `S`。

   4. 计算签名 `S = (r + S * a) mod l`，其中 `l` 是曲线的阶。

   5. 最终签名是 `(R, S)`。

      ```shell
      r = SHA-512(h[32..63] || M)
      R = r * B
      S = (r + H(R || A || M) * a) mod l
      signature: (R, S)
      ```

3. 签名验证：

   1. 计算哈希 `H(R || A || M)`，得到一个标量 `S`。

   2. 验证 `8S * B == 8R + 8H(R || A || M) * A`。

      ```shell
      Verify 8S * B == 8R + 8H(R || A || M) * A
      ```



## Sr25519

`sr25519` 是一种基于 Schnorr 签名方案的签名算法，使用 Ristretto 代替 Curve25519。该算法的主要优势在于其高效性、安全性以及抗量子攻击的能力

### 算法步骤

1. **密钥生成**:
   - 生成随机的私钥（sk）。
   - 计算相应的公钥（pk）。
2. **签名生成**:
   - 生成随机的 nonce（k）。
   - 计算 R = k * G，其中 G 是基点。
   - 计算哈希值 h = H(R, pk, message)。
   - 计算签名 
     $$
     s = k + h * sk
     $$
     。
3. **签名验证**:
   
   - 使用公钥和签名验证消息的完整性和真实性。
   - 计算 R' = s * G - H(R, pk, message) * pk。
   - 如果 R' 与 R 相同，则签名有效。

### sr25519 和 ed25519 签名算法的对比

`sr25519` 和 `ed25519` 都是基于椭圆曲线密码学的签名算法，但它们在设计和应用上有一些显著的区别。以下是对这两种签名算法的详细对比：

### 1. 基础曲线

- ed25519

  :

  - 基于 Edwards 曲线（Curve25519 的一个变体）。
  - 具体使用的曲线为 `Edwards25519`，定义为 `-x^2 + y^2 = 1 + d*x^2*y^2`，其中 `d` 是一个常数。

- sr25519

  :

  - 基于 Ristretto（Curve25519 的一种优化曲线表示）。
  - 使用 Ristretto255，Ristretto 是一种压缩表示，消除了曲线上的倍数问题，使得其适合于密码学应用。

### 2. 签名算法

- **ed25519**:
  - 使用 Schnorr-like 的签名方案，但实际上是基于 `EdDSA`（Edwards-curve Digital Signature Algorithm）。
  - 签名生成和验证过程简单，速度快。
- **sr25519**:
  - 基于 Schnorr 签名方案，但使用 Ristretto 来提高安全性和效率。
  - 提供了一些额外的功能，如多重签名和聚合签名。

### 3. 性能

- **ed25519**:
  - 签名生成和验证速度非常快，适合资源受限的设备。
  - 通常用于高效的签名生成和验证场景。
- **sr25519**:
  - 比 ed25519 稍微慢一些，但提供了更高的安全性。
  - 支持复杂的密码学操作，如多重签名和聚合签名。

### 4. 安全性

- **ed25519**:
  - 提供高度安全的签名方案。
  - 易于实现，且安全性已经在多个领域得到了验证。
- **sr25519**:
  - 进一步提高了安全性，特别是在抗多种攻击上有优势。
  - 采用了 Ristretto 来消除某些攻击向量，使得签名更为安全。

### 5. 应用场景

- **ed25519**:
  - 广泛应用于多种加密货币和区块链项目，如 Bitcoin、Ethereum、Monero 等。
  - 也用于 SSH 密钥、TLS 证书和其他需要高效签名的场景。
- **sr25519**:
  - 主要应用于 Polkadot 和 Substrate 生态系统。
  - 适用于需要更高安全性和复杂密码学操作的场景。
