## 一、椭圆曲线数字签名算法 (ECDSA)

**ECDSA**（Elliptic Curve Digital Signature Algorithm，椭圆曲线数字签名算法）是一种基于椭圆曲线密码学的签名算法，用于验证数字数据的真实性和完整性。

大致可以这么理解：

签名过程：ECDSA_正向算法（消息 + 私钥 + 随机数）= 签名_

验证过程：ECDSA_反向算法（消息 + 签名）= 公钥

### 1. 密钥生成

- **私钥 dd**：从 [1, n-1] 范围内随机选择一个整数，其中 nn 是椭圆曲线的阶。
- **公钥 QQ**：计算 
  $$
  Q = dG
  $$
  ，其中 
  $$
  G
  $$
   是椭圆曲线的基点。

### 2. 签名生成

1. **选择随机数 kk**：

   $$
    k \in [1, n-1]
   $$
   
2. **计算R**：
   $$
   R = KG
   $$
   取 R 的 x 坐标 r，若 
   $$
   r=0
   $$
   则重新选择 
   $$
   k
   $$
   
3. **计算 ss**：
$$
    s = k^{-1}(H(m) + dr) \mod n 
$$
   若 s=0 则重新选择 k。

4. **签名对 **
   $$
   (r,s)
   $$
   
   
   $$
   签名对 = (r,s)
   $$
   

### 3. 签名验证

1. **计算 w**：
   $$
   w = s^{-1} \mod n
   $$
   **计算 u1 和 u2**：
   $$
   u_1 = H(m)w \mod n
   $$

   $$
   u_2 = rw \mod n
   $$

   

2. **计算点 P**：
   $$
   P = u_{1}G+u_{2}Q
   $$
   
4. **验证 r**：
   $$
   r \equiv P_x \mod n
   $$
   若等式成立，则签名有效。



## 二、椭圆曲线 EdDSA 签名算法

签名简化：
$$
签名=EdDSA_{正向算法}(消息,私钥)
$$
验证：
$$
验证结果=EdDS_{反向算法}(消息+签名)
$$

$$
结果 \stackrel{?}{=} 公钥
$$



### 1. 密钥生成

- **私钥 k**：生成一个 256 位的随机数。
- **公钥 A**：计算 
  $$
  A=kB
  $$
  ，其中 B 是基点。

### 2. 签名生成

1. **计算随机数 r**：
   $$
   r=H(k∣∣m)
   $$
   
2. **计算承诺值 R**：
   $$
   R=rB
   $$
   
3. **生成挑战 h**：
   $$
   h=H(R∣∣A∣∣m)
   $$
   
4. **计算响应 S**：
   $$
   S = (r + hk) \mod L 
   $$
   
5. **签名对 (R,S)**：
   $$
   签名对=(R,S)
   $$
   

### 3. 签名验证

1. **生成挑战 h**：
   $$
   h=H(R∣∣A∣∣m)
   $$
   
2. **验证方程**：

   $$
   SB \stackrel{?}{=} R + hA
   $$
   若等式成立，则签名有效。



## 三、RSA 签名算法

签名：
$$
签名=RSA_{向算法}(消息+私钥)
$$
验证过程：
$$
验证结果=RSA_{反向算法}(消息+签名)
$$

$$
验证结果 \stackrel{?}{=}哈希值
$$



### 1. 密钥生成

1. **选择两个大素数 p 和 q**。

2. **计算 n**：
   $$
   n=pq
   $$
   
3. **计算欧拉函数 ϕ(n)ϕ(n)**：

   $$
   \phi(n) = (p-1)(q-1)
   $$
   
4. **选择 ee**：

   $$
   1 < e < \phi(n) \text{且} \gcd(e, \phi(n)) = 1 
   $$
   
5. **计算私钥 dd**：

   $$
   d = e^{-1} \mod \phi(n)
   $$
   

- **公钥**：
  $$
  (e,n)
  $$
  
- **私钥**：
  $$
  (d,n)
  $$
  

### 2. 签名生成

1. **计算消息的哈希 H(m)**。
2. **计算签名 ss**：
   $$
   s = H(m)^d \mod n
   $$
   

### 3. 签名验证

1. **计算验证值 vv**：

   $$
   v = s^e \mod n
   $$
   
2. **验证**：
   $$
   v \stackrel{?}{=} H(m)
   $$
   若等式成立，则签名有效。

“H” 是哈希函数，“m” 是消息，“n” 是模数，“p” 和 “q” 是大质数，“e” 是公钥，“d” 是私钥，“s” 是签名，“v” 是验证值。



## 总结

### 签名算法的特点

1. **ECDSA**：
   - **特点**：基于椭圆曲线密码学，公钥和私钥尺寸较小。
   - **优点**：高效，安全性较高。
   - **缺点**：签名生成和验证过程较为复杂。
2. **EdDSA**：
   - **特点**：基于 Edwards 曲线，具有高效和安全的特点。
   - **优点**：计算速度快，安全性高，支持批量验证。
   - **缺点**：实现较复杂。
4. **RSA**：
   - **特点**：基于大整数因子分解难题，历史悠久。
   - **优点**：安全性高，已广泛应用。
   - **缺点**：密钥尺寸大，计算量大，效率较低。

### 签名算法的优缺点

- **优点**：
  - 确保数据完整性和真实性。
  - 提供不可否认性，防止交易抵赖。
  - 有助于实现安全的多重签名和智能合约。
- **缺点**：
  - 计算复杂度高，特别是对资源有限的设备。
  - 密钥管理和存储需谨慎，防止私钥泄露。
  - 不同签名算法有不同的实现难度和效率要求。

